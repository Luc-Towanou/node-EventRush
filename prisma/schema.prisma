generator client {
  provider = "prisma-client-js"
  // output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
// model billets {
//   id                                                BigInt        @id @default(autoincrement())
//   event_id                                          BigInt
//   utilisateur_id                                    BigInt
//   ticket_id                                         BigInt
//   methode                                           String        @default("mobile_money") @db.VarChar(255)
//   status                                            String        @default("en_attente") @db.VarChar(255)
//   status_scan                                       String        @default("false") @db.VarChar(255)
//   scanned_at                                        DateTime?     @db.Date
//   montant                                           Decimal       @db.Decimal(10, 2)
//   qr_code                                           String?       @unique(map: "billets_qr_code_unique") @db.Uuid
//   reference                                         String        @unique(map: "billets_reference_unique") @db.VarChar(191)
//   billet_fedapay_id                                 BigInt?
//   created_at                                        DateTime?     @db.Timestamp(0)
//   updated_at                                        DateTime?     @db.Timestamp(0)
//   scanned_by                                        BigInt?
//   events                                            events        @relation(fields: [event_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "billets_event_id_foreign")
//   utilisateurs_billets_scanned_byToutilisateurs     utilisateurs? @relation("billets_scanned_byToutilisateurs", fields: [scanned_by], references: [id], onUpdate: NoAction, map: "billets_scanned_by_foreign")
//   tickets                                           tickets       @relation(fields: [ticket_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "billets_ticket_id_foreign")
//   utilisateurs_billets_utilisateur_idToutilisateurs utilisateurs  @relation("billets_utilisateur_idToutilisateurs", fields: [utilisateur_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "billets_utilisateur_id_foreign")
// }

// model commentaires {
//   id             BigInt       @id @default(autoincrement())
//   event_id       BigInt
//   utilisateur_id BigInt
//   contenu        String?
//   note           Int?         @db.SmallInt
//   created_at     DateTime?    @db.Timestamp(0)
//   updated_at     DateTime?    @db.Timestamp(0)
//   events         events       @relation(fields: [event_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "commentaires_event_id_foreign")
//   utilisateurs   utilisateurs @relation(fields: [utilisateur_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "commentaires_utilisateur_id_foreign")
// }

// model email_verifications {
//   id         BigInt    @id @default(autoincrement())
//   email      String    @unique(map: "email_verifications_email_unique") @db.VarChar(191)
//   token      String    @db.VarChar(191)
//   created_at DateTime? @db.Timestamp(0)
//   updated_at DateTime? @db.Timestamp(0)
// }

// model event_photos {
//   id         BigInt    @id @default(autoincrement())
//   event_id   BigInt
//   image_path String    @db.VarChar(191)
//   created_at DateTime? @db.Timestamp(0)
//   updated_at DateTime? @db.Timestamp(0)
//   events     events    @relation(fields: [event_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "event_photos_event_id_foreign")
// }

// model event_scanneurs {
//   id             BigInt       @id @default(autoincrement())
//   event_id       BigInt
//   utilisateur_id BigInt
//   created_at     DateTime?    @db.Timestamp(0)
//   updated_at     DateTime?    @db.Timestamp(0)
//   events         events       @relation(fields: [event_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "event_scanneurs_event_id_foreign")
//   utilisateurs   utilisateurs @relation(fields: [utilisateur_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "event_scanneurs_utilisateur_id_foreign")
// }

// model event_vues {
//   id             BigInt       @id @default(autoincrement())
//   event_id       BigInt
//   created_at     DateTime?    @db.Timestamp(0)
//   updated_at     DateTime?    @db.Timestamp(0)
//   utilisateur_id BigInt
//   events         events       @relation(fields: [event_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "event_vues_event_id_foreign")
//   utilisateurs   utilisateurs @relation(fields: [utilisateur_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "event_vues_utilisateur_id_foreign")
// }

// /// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
// model events {
//   id              BigInt            @id @default(autoincrement())
//   utilisateur_id  BigInt
//   titre           String            @db.VarChar(191)
//   description     String
//   date_debut      DateTime          @db.Date
//   date_fin        DateTime          @db.Date
//   lieu            String            @db.VarChar(191)
//   statut          String            @default("brouillon") @db.VarChar(255)
//   affiche         String?           @db.VarChar(191)
//   created_at      DateTime?         @db.Timestamp(0)
//   updated_at      DateTime?         @db.Timestamp(0)
//   points          Int               @default(0)
//   nbr_achat       Int               @default(0)
//   latitude        Decimal?          @db.Decimal(10, 8)
//   longitude       Decimal?          @db.Decimal(11, 8)
//   billets         billets[]
//   commentaires    commentaires[]
//   event_photos    event_photos[]
//   event_scanneurs event_scanneurs[]
//   event_vues      event_vues[]
//   utilisateurs    utilisateurs      @relation(fields: [utilisateur_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "events_utilisateur_id_foreign")
//   favoris         favoris[]
//   orders          orders[]
//   point_logs      point_logs[]
//   tests           tests[]
//   tickets         tickets[]
// }

// model failed_jobs {
//   id         BigInt   @id @default(autoincrement())
//   uuid       String   @unique(map: "failed_jobs_uuid_unique") @db.VarChar(191)
//   connection String
//   queue      String
//   payload    String
//   exception  String
//   failed_at  DateTime @default(now()) @db.Timestamp(0)
// }

// model favoris {
//   id             BigInt       @id @default(autoincrement())
//   utilisateur_id BigInt
//   event_id       BigInt
//   created_at     DateTime?    @db.Timestamp(0)
//   updated_at     DateTime?    @db.Timestamp(0)
//   events         events       @relation(fields: [event_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "favoris_event_id_foreign")
//   utilisateurs   utilisateurs @relation(fields: [utilisateur_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "favoris_utilisateur_id_foreign")

//   @@unique([utilisateur_id, event_id], map: "favoris_utilisateur_id_event_id_unique")
// }

// model migrations {
//   id        Int    @id @default(autoincrement())
//   migration String @db.VarChar(191)
//   batch     Int
// }

// model notifications {
//   id              String    @id @db.Uuid
//   type            String    @db.VarChar(191)
//   notifiable_type String    @db.VarChar(191)
//   notifiable_id   BigInt
//   data            String
//   read_at         DateTime? @db.Timestamp(0)
//   created_at      DateTime? @db.Timestamp(0)
//   updated_at      DateTime? @db.Timestamp(0)

//   @@index([notifiable_type, notifiable_id], map: "notifications_notifiable_type_notifiable_id_index")
// }

// /// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
// model orders {
//   id               BigInt         @id @default(autoincrement())
//   utilisateur_id   BigInt
//   event_id         BigInt
//   montantant_total Decimal        @db.Decimal(10, 2)
//   statut_paiement  String         @default("en_attente") @db.VarChar(255)
//   created_at       DateTime?      @db.Timestamp(0)
//   updated_at       DateTime?      @db.Timestamp(0)
//   events           events         @relation(fields: [event_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "orders_event_id_foreign")
//   utilisateurs     utilisateurs   @relation(fields: [utilisateur_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "orders_utilisateur_id_foreign")
//   paiements        paiements[]
//   transactions     transactions[]
// }

// model organisateur_profiles {
//   id             BigInt          @id @default(autoincrement())
//   utilisateur_id BigInt
//   nom_entreprise String?         @db.VarChar(191)
//   description    String?
//   logo           String?         @db.VarChar(191)
//   created_at     DateTime?       @db.Timestamp(0)
//   updated_at     DateTime?       @db.Timestamp(0)
//   utilisateurs   utilisateurs    @relation(fields: [utilisateur_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "organisateur_profiles_utilisateur_id_foreign")
//   souscriptions  souscriptions[]
// }

// /// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
// model paiements {
//   id         BigInt    @id @default(autoincrement())
//   order_id   BigInt
//   montant    Decimal   @db.Decimal(10, 2)
//   methode    String    @default("mobile_money") @db.VarChar(255)
//   statut     String    @default("en_attente") @db.VarChar(255)
//   created_at DateTime? @db.Timestamp(0)
//   updated_at DateTime? @db.Timestamp(0)
//   orders     orders    @relation(fields: [order_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "paiements_order_id_foreign")
// }

// model password_reset_tokens {
//   email      String    @id @db.VarChar(191)
//   token      String    @db.VarChar(191)
//   created_at DateTime? @db.Timestamp(0)
// }

// model personal_access_tokens {
//   id             BigInt    @id @default(autoincrement())
//   tokenable_type String    @db.VarChar(191)
//   tokenable_id   BigInt
//   name           String    @db.VarChar(191)
//   token          String    @unique(map: "personal_access_tokens_token_unique") @db.VarChar(64)
//   abilities      String?
//   last_used_at   DateTime? @db.Timestamp(0)
//   expires_at     DateTime? @db.Timestamp(0)
//   created_at     DateTime? @db.Timestamp(0)
//   updated_at     DateTime? @db.Timestamp(0)

//   @@index([tokenable_type, tokenable_id], map: "personal_access_tokens_tokenable_type_tokenable_id_index")
// }

// model plans_souscriptions {
//   id            BigInt          @id @default(autoincrement())
//   nom           String          @db.VarChar(191)
//   description   String?
//   prix          Decimal         @db.Decimal(10, 2)
//   duree_jours   Int
//   created_at    DateTime?       @db.Timestamp(0)
//   updated_at    DateTime?       @db.Timestamp(0)
//   souscriptions souscriptions[]
// }

// model point_logs {
//   id             BigInt        @id @default(autoincrement())
//   utilisateur_id BigInt?
//   event_id       BigInt?
//   type           String        @db.VarChar(191)
//   points         Int
//   created_at     DateTime?     @db.Timestamp(0)
//   updated_at     DateTime?     @db.Timestamp(0)
//   events         events?       @relation(fields: [event_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "point_logs_event_id_foreign")
//   utilisateurs   utilisateurs? @relation(fields: [utilisateur_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "point_logs_utilisateur_id_foreign")

//   @@unique([utilisateur_id, event_id, type], map: "point_logs_utilisateur_id_event_id_type_unique")
// }

// /// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
// model souscriptions {
//   id                      BigInt                @id @default(autoincrement())
//   organisateur_id         BigInt
//   utilisateur_id          BigInt
//   date_debut              DateTime              @db.Date
//   date_fin                DateTime              @db.Date
//   statut                  String                @default("actif") @db.VarChar(255)
//   methode                 String                @default("mobile_money") @db.VarChar(255)
//   statut_paiement         String                @default("en_attente") @db.VarChar(255)
//   montant                 Decimal               @db.Decimal(10, 2)
//   reference               String                @unique(map: "souscriptions_reference_unique") @db.VarChar(191)
//   souscription_fedapay_id BigInt?
//   created_at              DateTime?             @db.Timestamp(0)
//   updated_at              DateTime?             @db.Timestamp(0)
//   plans_souscription_id   BigInt
//   organisateur_profiles   organisateur_profiles @relation(fields: [organisateur_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "souscriptions_organisateur_id_foreign")
//   plans_souscriptions     plans_souscriptions   @relation(fields: [plans_souscription_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "souscriptions_plans_souscription_id_foreign")
//   utilisateurs            utilisateurs          @relation(fields: [utilisateur_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "souscriptions_utilisateur_id_foreign")
//   transactions            transactions[]
// }

// model suivis {
//   id                                               BigInt       @id @default(autoincrement())
//   utilisateur_id                                   BigInt
//   suivi_id                                         BigInt
//   created_at                                       DateTime?    @db.Timestamp(0)
//   updated_at                                       DateTime?    @db.Timestamp(0)
//   utilisateurs_suivis_suivi_idToutilisateurs       utilisateurs @relation("suivis_suivi_idToutilisateurs", fields: [suivi_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "suivis_suivi_id_foreign")
//   utilisateurs_suivis_utilisateur_idToutilisateurs utilisateurs @relation("suivis_utilisateur_idToutilisateurs", fields: [utilisateur_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "suivis_utilisateur_id_foreign")
// }

// model tags {
//   id         BigInt    @id @default(autoincrement())
//   nom        String    @unique(map: "tags_nom_unique") @db.VarChar(191)
//   created_at DateTime? @db.Timestamp(0)
//   updated_at DateTime? @db.Timestamp(0)
// }

// model tests {
//   id          BigInt    @id @default(autoincrement())
//   qr_code     String    @unique(map: "tests_qr_code_unique") @db.VarChar(191)
//   event_id    BigInt
//   status_scan String    @default("non_scanné") @db.VarChar(191)
//   scanned_at  DateTime? @db.Timestamp(0)
//   created_at  DateTime? @db.Timestamp(0)
//   updated_at  DateTime? @db.Timestamp(0)
//   image       String?   @db.VarChar(191)
//   events      events    @relation(fields: [event_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "tests_event_id_foreign")
// }

// /// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
// model tickets {
//   id                  BigInt    @id @default(autoincrement())
//   event_id            BigInt
//   type                String    @default("standart") @db.VarChar(191)
//   prix                Decimal   @db.Decimal(8, 2)
//   image               String?   @db.VarChar(191)
//   quantit__disponible Int       @map("quantité_disponible")
//   created_at          DateTime? @db.Timestamp(0)
//   updated_at          DateTime? @db.Timestamp(0)
//   date_limite_vente   DateTime? @db.Timestamp(0)
//   quantite_restante   Int       @default(0)
//   billets             billets[]
//   events              events    @relation(fields: [event_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "tickets_event_id_foreign")
// }

// /// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
// model transactions {
//   id              BigInt         @id @default(autoincrement())
//   utilisateur_id  BigInt
//   order_id        BigInt?
//   souscription_id BigInt?
//   reference       String         @unique(map: "transactions_reference_unique") @db.VarChar(191)
//   methode         String         @default("mobile_money") @db.VarChar(255)
//   status          String         @default("en_attente") @db.VarChar(255)
//   montant         Decimal        @db.Decimal(10, 2)
//   created_at      DateTime?      @db.Timestamp(0)
//   updated_at      DateTime?      @db.Timestamp(0)
//   orders          orders?        @relation(fields: [order_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "transactions_order_id_foreign")
//   souscriptions   souscriptions? @relation(fields: [souscription_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "transactions_souscription_id_foreign")
//   utilisateurs    utilisateurs   @relation(fields: [utilisateur_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "transactions_utilisateur_id_foreign")
// }

// model users {
//   id                BigInt    @id @default(autoincrement())
//   name              String    @db.VarChar(191)
//   email             String    @unique(map: "users_email_unique") @db.VarChar(191)
//   email_verified_at DateTime? @db.Timestamp(0)
//   password          String    @db.VarChar(191)
//   remember_token    String?   @db.VarChar(100)
//   created_at        DateTime? @db.Timestamp(0)
//   updated_at        DateTime? @db.Timestamp(0)
// }

// /// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
// model utilisateurs {
//   id                                           BigInt                  @id @default(autoincrement())
//   nom                                          String                  @db.VarChar(191)
//   email                                        String                  @unique(map: "utilisateurs_email_unique") @db.VarChar(191)
//   email_verified_at                            DateTime?               @db.Timestamp(0)
//   password                                     String                  @db.VarChar(191)
//   avatar                                       String?                 @db.VarChar(191)
//   otp                                          String?                 @db.VarChar(191)
//   otp_expires_at                               DateTime?               @db.Timestamp(0)
//   role                                         String                  @default("client") @db.VarChar(191)
//   created_at                                   DateTime?               @db.Timestamp(0)
//   updated_at                                   DateTime?               @db.Timestamp(0)
//   last_seen_at                                 DateTime?               @db.Timestamp(0)
//   google_id                                    String?                 @db.VarChar(191)
//   points                                       Int                     @default(0)
//   statut_compte                                String                  @default("actif") @db.VarChar(191)
//   billets_billets_scanned_byToutilisateurs     billets[]               @relation("billets_scanned_byToutilisateurs")
//   billets_billets_utilisateur_idToutilisateurs billets[]               @relation("billets_utilisateur_idToutilisateurs")
//   commentaires                                 commentaires[]
//   event_scanneurs                              event_scanneurs[]
//   event_vues                                   event_vues[]
//   events                                       events[]
//   favoris                                      favoris[]
//   orders                                       orders[]
//   organisateur_profiles                        organisateur_profiles[]
//   point_logs                                   point_logs[]
//   souscriptions                                souscriptions[]
//   suivis_suivis_suivi_idToutilisateurs         suivis[]                @relation("suivis_suivi_idToutilisateurs")
//   suivis_suivis_utilisateur_idToutilisateurs   suivis[]                @relation("suivis_utilisateur_idToutilisateurs")
//   transactions                                 transactions[]
// }

// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// generator client {
//   provider = "prisma-client-js"
// }

// datasource db {
//   provider = "postgresql"
//   url      = env("DATABASE_URL")
// }

model Articles {
  id            BigInt    @id @default(autoincrement())
  utilisateur_id BigInt?   @map("utilisateur_id")
  description   String?
  type          String?
  objet_statut   String    @default("actif") @map("objet_statut")
  title         String
  excerpt       String?
  content       String
  cover         String?
  read_time      String?   @map("read_time")
  created_at     DateTime? @map("created_at") @db.Timestamp(6)
  updated_at     DateTime? @map("updated_at") @db.Timestamp(6)

  utilisateurs Utilisateurs? @relation(fields: [utilisateur_id], references: [id])

  @@map("articles")
}

model Badges {
  id          BigInt    @id @default(autoincrement())
  nom         String
  icone       String?
  description String?
  createdAt   DateTime? @map("created_at") @db.Timestamp(6)
  updatedAt   DateTime? @map("updated_at") @db.Timestamp(6)

  utilisateurs Utilisateur_badges[]

  @@map("badges")
}

model BilletScanEnAttente {
  id          BigInt    @id @default(autoincrement())
  billet_id    BigInt    @map("billet_id")
  scanneur_id  BigInt    @map("scanneur_id")
  initiated_at DateTime  @map("initiated_at") @db.Timestamp(6)
  code        String    @unique
  status      String    @default("en_attente") // CHECK: en_attente, validé, rejeté
  expires_at   DateTime? @map("expires_at") @db.Timestamp(6)
  created_at   DateTime? @map("created_at") @db.Timestamp(6)
  updated_at   DateTime? @map("updated_at") @db.Timestamp(6)

  billet   Billet      @relation(fields: [billet_id], references: [id])
  scanneurs Utilisateurs @relation(fields: [scanneur_id], references: [id])

  @@map("billet_scans_en_attente")
}

model Billet {
  id             BigInt    @id @default(autoincrement())
  event_id        BigInt    @map("event_id")
  utilisateur_id  BigInt    @map("utilisateur_id")
  ticket_id       BigInt    @map("ticket_id")
  methode        String    @default("mobile_money") // CHECK: carte, PayPal, mobile_money
  status         String    @default("en_attente") // CHECK: en_attente, paye, echoue
  statusScan     String    @default("false") @map("status_scan") // CHECK: false, scanné
  scannedAt      DateTime? @map("scanned_at") @db.Date
  montant        Decimal   @db.Decimal
  qrCode         String?   @unique @map("qr_code") @db.Uuid
  reference      String    @unique
  billet_fedapay_id BigInt?  @map("billet_fedapay_id")
  created_at      DateTime? @map("created_at") @db.Timestamp(6)
  updated_at      DateTime? @map("updated_at") @db.Timestamp(6)
  scanned_by      BigInt?   @map("scanned_by")

  events           Events                 @relation(fields: [event_id], references: [id])
  scanneurs        Utilisateurs?          @relation("BilletScanneur", fields: [scanned_by], references: [id])
  ticket          Ticket                @relation(fields: [ticket_id], references: [id])
  utilisateurs     Utilisateurs           @relation("BilletPossesseur", fields: [utilisateur_id], references: [id])
  scansEnAttente  BilletScanEnAttente[]

  @@map("billets")
}

model Commentaire {
  id              BigInt    @id @default(autoincrement())
  utilisateurId   BigInt    @map("utilisateur_id")
  contenu         String?
  note            Int?      @db.SmallInt
  createdAt       DateTime? @map("created_at") @db.Timestamp(6)
  updatedAt       DateTime? @map("updated_at") @db.Timestamp(6)
  commentableId   BigInt?   @map("commentable_id")
  commentableType String?   @map("commentable_type")

  utilisateur Utilisateurs @relation(fields: [utilisateurId], references: [id])

  @@map("commentaires")
}

model Community_posts {
  id            BigInt    @id @default(autoincrement())
  utilisateur_id BigInt    @map("utilisateur_id")
  contenu       String
  image         String?
  description   String?
  type          String?
  objet_statut   String    @default("actif") @map("objet_statut")
  created_at     DateTime? @map("created_at") @db.Timestamp(6)
  updated_at     DateTime? @map("updated_at") @db.Timestamp(6)

  utilisateurs Utilisateurs @relation(fields: [utilisateur_id], references: [id])

  @@map("community_posts")
}

model email_verifications {
  id        BigInt    @id @default(autoincrement())
  email     String    @unique
  token     String
  created_at DateTime? @map("created_at") @db.Timestamp(6)
  updated_at DateTime? @map("updated_at") @db.Timestamp(6)

  @@map("email_verifications")
}

model Event_highlights {
  id            BigInt    @id @default(autoincrement())
  utilisateur_id BigInt?   @map("utilisateur_id")
  description   String?
  type          String?
  objet_statut   String    @default("actif") @map("objet_statut")
  event_id       BigInt?   @map("event_id")
  media_path     String?   @map("media_path")
  created_at     DateTime? @map("created_at") @db.Timestamp(6)
  updated_at     DateTime? @map("updated_at") @db.Timestamp(6)

  utilisateurs Utilisateurs? @relation(fields: [utilisateur_id], references: [id])
  events       Events?       @relation(fields: [event_id], references: [id])

  @@map("event_highlights")
}

model Event_photos {
  id        BigInt    @id @default(autoincrement())
  eventId   BigInt    @map("event_id")
  imagePath String    @map("image_path")
  createdAt DateTime? @map("created_at") @db.Timestamp(6)
  updatedAt DateTime? @map("updated_at") @db.Timestamp(6)

  events Events @relation(fields: [eventId], references: [id])

  @@map("event_photos")
}

model Event_posts {
  id            BigInt    @id @default(autoincrement())
  event_id       BigInt    @map("event_id")
  utilisateur_id BigInt    @map("utilisateur_id")
  titre         String
  contenu       String
  image         String?
  created_at     DateTime? @map("created_at") @db.Timestamp(6)
  updated_at     DateTime? @map("updated_at") @db.Timestamp(6)

  events       Events       @relation(fields: [event_id], references: [id])
  utilisateurs Utilisateurs @relation(fields: [utilisateur_id], references: [id])

  @@map("event_posts")
}

model EventScanneur {
  id            BigInt    @id @default(autoincrement())
  eventId       BigInt    @map("event_id")
  utilisateurId BigInt    @map("utilisateur_id")
  createdAt     DateTime? @map("created_at") @db.Timestamp(6)
  updatedAt     DateTime? @map("updated_at") @db.Timestamp(6)

  events       Events       @relation(fields: [eventId], references: [id])
  utilisateurs Utilisateurs @relation(fields: [utilisateurId], references: [id])

  @@map("event_scanneurs")
}

model EventTag {
  event_id   BigInt    @map("event_id")
  tag_id     BigInt    @map("tag_id")
  createdAt DateTime? @map("created_at") @db.Timestamp(6)
  updatedAt DateTime? @map("updated_at") @db.Timestamp(6)

  events Events @relation(fields: [event_id], references: [id])
  tag   Tags   @relation(fields: [tag_id], references: [id])

  @@id([event_id, tag_id])
  @@map("event_tag")
}

model EventVue {
  id            BigInt    @id @default(autoincrement())
  event_id       BigInt    @map("event_id")
  created_at     DateTime? @map("created_at") @db.Timestamp(6)
  updated_at     DateTime? @map("updated_at") @db.Timestamp(6)
  utilisateur_id BigInt?   @map("utilisateur_id")
  adresse_ip     String?   @map("adresse_ip")

  events Events @relation(fields: [event_id], references: [id])

  @@map("event_vues")
}

model Events {
  id            BigInt    @id @default(autoincrement())
  utilisateur_id BigInt    @map("utilisateur_id")
  titre         String
  description   String
  date_debut     DateTime  @map("date_debut") @db.Date
  date_fin       DateTime  @map("date_fin") @db.Date
  lieu          String
  statut        String    @default("brouillon") // CHECK: brouillon, publié, annulé
  affiche       String?
  created_at     DateTime? @map("created_at") @db.Timestamp(6)
  updated_at     DateTime? @map("updated_at") @db.Timestamp(6)
  points        Int       @default(0)
  nbr_achat      Int       @default(0) @map("nbr_achat")
  latitude      Decimal?  @db.Decimal
  longitude     Decimal?  @db.Decimal

  organisateurs    Utilisateurs      @relation(fields: [utilisateur_id], references: [id])
  billets         Billet[]
  eventHighlights Event_highlights[]
  eventPhotos     Event_photos[]
  eventPosts      Event_posts[]
  eventScanneurs  EventScanneur[]
  tags            EventTag[]
  vues            EventVue[]
  favoris         Favori[]
  orders          Order[]
  pointLogs       PointLog[]
  tests           Tests[]
  tickets         Ticket[]

  @@map("events")
}

model failed_jobs {
  id        BigInt   @id @default(autoincrement())
  uuid      String   @unique
  connection String
  queue     String
  payload   String
  exception String
  failed_at  DateTime @default(now()) @map("failed_at") @db.Timestamp(6)

  @@map("failed_jobs")
}

model Favori {
  id            BigInt    @id @default(autoincrement())
  utilisateur_id BigInt    @map("utilisateur_id")
  event_id       BigInt    @map("event_id")
  created_at     DateTime? @map("created_at") @db.Timestamp(6)
  updated_at     DateTime? @map("updated_at") @db.Timestamp(6)

  eventss       Events       @relation(fields: [event_id], references: [id])
  utilisateurs Utilisateurs @relation(fields: [utilisateur_id], references: [id])

  @@map("favoris")
}

model Lifestyle_posts {
  id          BigInt    @id @default(autoincrement())
  title       String
  image       String?
  category    String?
  description String?
  type        String?
  objet_statut String    @default("actif") @map("objet_statut")
  created_at   DateTime? @map("created_at") @db.Timestamp(6)
  updated_at   DateTime? @map("updated_at") @db.Timestamp(6)

  @@map("lifestyle_posts")
}

model Migration {
  id        Int    @id @default(autoincrement())
  migration String
  batch     Int

  @@map("migrations")
}

model Notification {
  id             String    @id @db.Uuid
  type           String
  notifiableType String    @map("notifiable_type")
  notifiableId   BigInt    @map("notifiable_id")
  data           String
  readAt         DateTime? @map("read_at") @db.Timestamp(6)
  createdAt      DateTime? @map("created_at") @db.Timestamp(6)
  updatedAt      DateTime? @map("updated_at") @db.Timestamp(6)

  @@map("notifications")
}

model Order {
  id              BigInt    @id @default(autoincrement())
  utilisateur_id   BigInt    @map("utilisateur_id")
  event_id         BigInt    @map("event_id")
  montantTotal    Decimal   @map("montantant_total") @db.Decimal
  statut_paiement  String    @default("en_attente") @map("statut_paiement") // CHECK: en_attente, payé, annulé
  created_at       DateTime? @map("created_at") @db.Timestamp(6)
  updated_at       DateTime? @map("updated_at") @db.Timestamp(6)

  events        Events         @relation(fields: [event_id], references: [id])
  utilisateurs  Utilisateurs   @relation(fields: [utilisateur_id], references: [id])
  paiements    Paiement[]
  transactions Transaction[]

  @@map("orders")
}

model OrganisateurProfile {
  id            BigInt    @id @default(autoincrement())
  utilisateur_id BigInt    @map("utilisateur_id")
  nom_entreprise String?   @map("nom_entreprise")
  description   String?
  logo          String?
  createdAt     DateTime? @map("created_at") @db.Timestamp(6)
  updatedAt     DateTime? @map("updated_at") @db.Timestamp(6)

  utilisateurs   Utilisateurs    @relation(fields: [utilisateur_id], references: [id])
  souscriptions Souscription[]

  @@map("organisateur_profiles")
}

model Paiement {
  id        BigInt    @id @default(autoincrement())
  orderId   BigInt    @map("order_id")
  montant   Decimal   @db.Decimal
  methode   String    @default("mobile_money") // CHECK: carte, PayPal, mobile_money
  statut    String    @default("en_attente") // CHECK: en_attente, confirmé, échoué
  createdAt DateTime? @map("created_at") @db.Timestamp(6)
  updatedAt DateTime? @map("updated_at") @db.Timestamp(6)

  order Order @relation(fields: [orderId], references: [id])

  @@map("paiements")
}

model PasswordResetToken {
  email     String    @id
  token     String
  createdAt DateTime? @map("created_at") @db.Timestamp(6)

  @@map("password_reset_tokens")
}

model personal_access_tokens {
  id            BigInt    @id @default(autoincrement())
  tokenable_type String    @map("tokenable_type")
  tokenable_id   BigInt    @map("tokenable_id")
  name          String
  token         String    @unique
  abilities     String?
  lastUsedAt    DateTime? @map("last_used_at") @db.Timestamp(6)
  expiresAt     DateTime? @map("expires_at") @db.Timestamp(6)
  createdAt     DateTime? @map("created_at") @db.Timestamp(6)
  updatedAt     DateTime? @map("updated_at") @db.Timestamp(6)

  @@map("personal_access_tokens")
}

model PlansSouscription {
  id          BigInt    @id @default(autoincrement())
  nom         String
  description String?
  prix        Decimal   @db.Decimal
  dureeJours  Int       @map("duree_jours")
  createdAt   DateTime? @map("created_at") @db.Timestamp(6)
  updatedAt   DateTime? @map("updated_at") @db.Timestamp(6)

  souscriptions Souscription[]

  @@map("plans_souscriptions")
}

model PointLog {
  id            BigInt    @id @default(autoincrement())
  utilisateur_id BigInt?   @map("utilisateur_id")
  event_id       BigInt?   @map("event_id")
  type          String
  points        Int
  created_at     DateTime? @map("created_at") @db.Timestamp(6)
  updated_at     DateTime? @map("updated_at") @db.Timestamp(6)

  events       Events?       @relation(fields: [event_id], references: [id])
  utilisateurs Utilisateurs? @relation(fields: [utilisateur_id], references: [id])

  @@map("point_logs")
}

model PollOption {
  id          BigInt    @id @default(autoincrement())
  poll_id      BigInt    @map("poll_id")
  text        String
  votes       Int       @default(0)
  description String?
  type        String?
  actif String    @default("actif") @map("objet_statut")
  created_at   DateTime? @map("created_at") @db.Timestamp(6)
  updated_at   DateTime? @map("updated_at") @db.Timestamp(6)

  polls Polls @relation(fields: [poll_id], references: [id])

  @@map("poll_options")
}

model Polls {
  id          BigInt    @id @default(autoincrement())
  question    String
  description String?
  type        String
  objet_statut String    @default("actif") @map("objet_statut")
  created_at   DateTime? @map("created_at") @db.Timestamp(6)
  updated_at   DateTime? @map("updated_at") @db.Timestamp(6)

  options PollOption[]

  @@map("polls")
}

model Promos {
  id            BigInt    @id @default(autoincrement())
  utilisateur_id BigInt?   @map("utilisateur_id")
  title         String
  caption       String
  icon          String?
  color         String?
  image         String?
  description   String?
  type          String?
  objet_statut   String    @default("actif") @map("objet_statut")
  created_at     DateTime? @map("created_at") @db.Timestamp(6)
  updated_at     DateTime? @map("updated_at") @db.Timestamp(6)

  utilisateurs Utilisateurs? @relation(fields: [utilisateur_id], references: [id])

  @@map("promos")
}

model Reactions {
  id            BigInt    @id @default(autoincrement())
  utilisateur_id BigInt    @map("utilisateur_id")
  type          String    @default("like")
  reactable_type String    @map("reactable_type")
  reactable_id   BigInt    @map("reactable_id")
  created_at     DateTime? @map("created_at") @db.Timestamp(6)
  updated_at     DateTime? @map("updated_at") @db.Timestamp(6)

  utilisateurs Utilisateurs @relation(fields: [utilisateur_id], references: [id])

  @@map("reactions")
}

model Shares {
  id            BigInt    @id @default(autoincrement())
  utilisateur_id BigInt    @map("utilisateur_id")
  shareable_type String    @map("shareable_type")
  shareable_id   BigInt    @map("shareable_id")
  created_at     DateTime? @map("created_at") @db.Timestamp(6)
  updated_at     DateTime? @map("updated_at") @db.Timestamp(6)

  utilisateurs Utilisateurs @relation(fields: [utilisateur_id], references: [id])

  @@map("shares")
}

model Souscription {
  id                   BigInt    @id @default(autoincrement())
  organisateur_id       BigInt    @map("organisateur_id")
  utilisateur_id        BigInt    @map("utilisateur_id")
  date_debut            DateTime  @map("date_debut") @db.Date
  date_fin              DateTime  @map("date_fin") @db.Date
  statut               String    @default("actif") // CHECK: actif, expiré, annulé
  methode              String    @default("mobile_money") // CHECK: carte, PayPal, mobile_money
  statutPaiement       String    @default("en_attente") @map("statut_paiement") // CHECK: en_attente, success, echoue
  montant              Decimal   @db.Decimal
  reference            String    @unique
  souscription_fedapay_id BigInt?  @map("souscription_fedapay_id")
  created_at            DateTime? @map("created_at") @db.Timestamp(6)
  updated_at            DateTime? @map("updated_at") @db.Timestamp(6)
  plans_souscription_id  BigInt    @map("plans_souscription_id")

  organisateurProfile OrganisateurProfile @relation(fields: [organisateur_id], references: [id])
  plan                PlansSouscription   @relation(fields: [plans_souscription_id], references: [id])
  utilisateurs         Utilisateurs         @relation(fields: [utilisateur_id], references: [id])
  transactions        Transaction[]

  @@map("souscriptions")
}

model Stories {
  id            BigInt    @id @default(autoincrement())
  utilisateur_id BigInt    @map("utilisateur_id")
  media_path     String    @map("media_path")
  expires_at     DateTime  @map("expires_at") @db.Timestamp(6)
  created_at     DateTime? @map("created_at") @db.Timestamp(6)
  updated_at     DateTime? @map("updated_at") @db.Timestamp(6)

  utilisateurs Utilisateurs @relation(fields: [utilisateur_id], references: [id])

  @@map("stories")
}

model Suivi {
  id            BigInt    @id @default(autoincrement())
  utilisateur_id BigInt    @map("utilisateur_id")
  suivi_id       BigInt    @map("suivi_id")
  created_at     DateTime? @map("created_at") @db.Timestamp(6)
  updated_at     DateTime? @map("updated_at") @db.Timestamp(6)

  follower  Utilisateurs @relation("UserFollowers", fields: [utilisateur_id], references: [id])
  following Utilisateurs @relation("UserFollowing", fields: [suivi_id], references: [id])

  @@map("suivis")
}

model Tags {
  id        BigInt    @id @default(autoincrement())
  nom       String    @unique
  created_at DateTime? @map("created_at") @db.Timestamp(6)
  updated_at DateTime? @map("updated_at") @db.Timestamp(6)

  events       EventTag[]
  utilisateurs Utilisateur_tags[]

  @@map("tags")
}

model Tests {
  id         BigInt    @id @default(autoincrement())
  qr_code     String    @unique @map("qr_code")
  event_id    BigInt    @map("event_id")
  status_scan String    @default("non_scanné") @map("status_scan")
  scanned_at  DateTime? @map("scanned_at") @db.Timestamp(6)
  created_at  DateTime? @map("created_at") @db.Timestamp(6)
  updated_at  DateTime? @map("updated_at") @db.Timestamp(6)
  image      String?

  events Events @relation(fields: [event_id], references: [id])

  @@map("tests")
}

model Ticket {
  id                 BigInt    @id @default(autoincrement())
  eventId            BigInt    @map("event_id")
  type               String    @default("standart")
  prix               Decimal   @db.Decimal
  image              String?
  quantiteDisponible Int       @map("quantité_disponible")
  createdAt          DateTime? @map("created_at") @db.Timestamp(6)
  updatedAt          DateTime? @map("updated_at") @db.Timestamp(6)
  dateLimiteVente    DateTime? @map("date_limite_vente") @db.Timestamp(6)
  quantiteRestante   Int       @default(0) @map("quantite_restante")

  events   Events    @relation(fields: [eventId], references: [id])
  billets Billet[]

  @@map("tickets")
}

model Transaction {
  id             BigInt    @id @default(autoincrement())
  utilisateur_id  BigInt    @map("utilisateur_id")
  order_id        BigInt?   @map("order_id")
  souscription_id BigInt?   @map("souscription_id")
  reference      String    @unique
  mobile_money        String    @default("mobile_money") // CHECK: carte, PayPal, mobile_money
  en_attente         String    @default("en_attente") // CHECK: en_attente, reussi, echoue
  montant        Decimal   @db.Decimal
  created_at      DateTime? @map("created_at") @db.Timestamp(6)
  updated_at      DateTime? @map("updated_at") @db.Timestamp(6)

  order        Order?        @relation(fields: [order_id], references: [id])
  souscription Souscription? @relation(fields: [souscription_id], references: [id])
  utilisateurs  Utilisateurs   @relation(fields: [utilisateur_id], references: [id])

  @@map("transactions")
}

// Table users par defaut (peut-etre inutile si Utilisateur est la table principale)
model User {
  id              BigInt    @id @default(autoincrement())
  name            String
  email           String    @unique
  emailVerifiedAt DateTime? @map("email_verified_at") @db.Timestamp(6)
  password        String
  rememberToken   String?   @map("remember_token")
  createdAt       DateTime? @map("created_at") @db.Timestamp(6)
  updatedAt       DateTime? @map("updated_at") @db.Timestamp(6)

  @@map("users")
}

model Utilisateur_badges {
  id            BigInt    @id @default(autoincrement())
  utilisateur_id BigInt    @map("utilisateur_id")
  badge_id       BigInt    @map("badge_id")
  created_at     DateTime? @map("created_at") @db.Timestamp(6)
  updated_at     DateTime? @map("updated_at") @db.Timestamp(6)

  badge       Badges       @relation(fields: [badge_id], references: [id])
  utilisateurs Utilisateurs @relation(fields: [utilisateur_id], references: [id])

  @@map("utilisateur_badges")
}

model Utilisateur_tags {
  utilisateur_id BigInt    @map("utilisateur_id")
  tag_id         BigInt    @map("tag_id")
  created_at     DateTime? @map("created_at") @db.Timestamp(6)
  updated_at     DateTime? @map("updated_at") @db.Timestamp(6)

  tag         Tags         @relation(fields: [tag_id], references: [id])
  utilisateurs Utilisateurs @relation(fields: [utilisateur_id], references: [id])

  @@id([utilisateur_id, tag_id])
  @@map("utilisateur_tag")
}

model Utilisateurs {
  id              BigInt    @id @default(autoincrement())
  nom             String
  email           String    @unique
  email_verified_at DateTime? @map("email_verified_at") @db.Timestamp(6)
  password        String
  avatar          String?
  otp             String?
  otp_expires_at    DateTime? @map("otp_expires_at") @db.Timestamp(6)
  role            String    @default("client") // CHECK: client, organisateur, scanneur, admin
  created_at       DateTime? @map("created_at") @db.Timestamp(6)
  updated_at       DateTime? @map("updated_at") @db.Timestamp(6)
  last_seen_at      DateTime? @map("last_seen_at") @db.Timestamp(6)
  google_id        String?   @map("google_id")
  points          Int       @default(0)
  statut_compte    String    @default("actif") @map("statut_compte")

  articles            Articles[]
  badges              Utilisateur_badges[]
  billetsPossedes     Billet[]              @relation("BilletPossesseur")
  billetsScannes      Billet[]              @relation("BilletScanneur")
  billetScans         BilletScanEnAttente[]
  commentaires        Commentaire[]
  community_posts      Community_posts[]
  eventHighlights     Event_highlights[]
  eventPosts          Event_posts[]
  eventScanneurs      EventScanneur[]
  eventsOrganises     Events[]
  favoris             Favori[]
  orders              Order[]
  organisateurProfile OrganisateurProfile[]
  pointLogs           PointLog[]
  promos              Promos[]
  reactions           Reactions[]
  shares              Shares[]
  souscriptions       Souscription[]
  stories             Stories[]
  tags                Utilisateur_tags[]
  transactions        Transaction[]
  
  // Relations d'auto-jointure (Suivis)
  followers           Suivi[]               @relation("UserFollowers")
  following           Suivi[]               @relation("UserFollowing")

  @@map("utilisateurs")
}